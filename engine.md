# 자바스크립트 엔진

- 콜스택

  - 코드가 실행될 때, 순차적으로 콜 스택에 푸쉬되어 실행된다.
  - 자바스크립트 엔진에는 단 하나의 콜 스택이 있기(싱글 스레드와 연관) 때문에 한 번에 하나의 테스크만 처리할 수 있다.
  - 함수를 실해하면 해당 함수의기록을 스택 맨 위에 추가하고, 결과 값을 반환하면 스택에 쌓여있던 함수가 제거되는 방식으로 작동한다.

- 힙

  - 객체에 대한 모든 메모리 할당을 한다. 즉, 힙에 객체가 저장된다.

  - 객체는 원시 값과 달리 크기가 정해져 있지 않기 때문에, 할당해야할 메모리 공간의 크기를 런타임에 결정한다.

  - 힙은 구조화 되어있지 않다.

- 스택 오버플로우

스택의 사이즈를 초과했을 때, 발생하는 오류이다. 예를들어, 종료 조건이 없는 재귀함수를 호출했을 때 콜 스택에 호출한 함수가 계속 쌓이게 된다. 그렇게 진행이 되다보면 콜 스택의 크기를 초과하게 되고 에러를 발생시키면서 함수를 종료시킨다.

- 단일 콜 스택의 문제

자바스크립트 엔진은 하나의 콜 스택이 존재하기 때문에, 하나의 작업이 매우 오래 걸리는 경우 다른 작업에 지장을 줄 수 있다. 이러한 상황을 극복하기 위해서 브라우저 혹은 Node.js는 이벤트 루프와 콜백 큐를 제공한다.

- 런타임 환경

  - 브라우저 혹은 Node.js에는 이벤트 루프, 콜백 큐가 있다. 이는 비동기 방식으로 동작하는 경우 주로 활용된다.

  - 이벤트 루프: 콜 스택에 현재 실행 중인 컨텍스트가 있는지, 콜백 큐에 대기 중인 함수가 있는지 반복해서 확인한다. 콜 스택이 비어 있고 태스크 큐에 대기 중인 함수가 있다면, 이벤트 루프는 순차적으로 태스크 큐에 대기중인 함수를 콜 스택으로 이동시킨다.

  - 콜백 큐: 비동기 함수의 콜백 함수 또는 이벤트 핸들러가 일시적으로 보관되는 영역
